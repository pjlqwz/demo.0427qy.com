<!DOCTYPE HTML>
<html>
<head>
<meta charset="utf-8">
<title>找回密码-某某公司</title>
<meta name="renderer" content="webkit">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
<link href="/8744/favicon.ico" rel="shortcut icon" type="image/x-icon">
    <link rel="stylesheet" type="text/css" href="static/css/basic-1613801932.css"><link rel="stylesheet" type="text/css" href="static/css/eyoucms.css">    
<!-- 官方内置样式表，升级会覆盖变动，请勿修改，否则后果自负 -->

<style>
    .panel-default .panel-heading strong{border-bottom: 2px solid #ff6565;color: #ff6565;}
    .panel-default .panel-heading span{color:#ff6565}
    .btn-primary{background: #ff6565 !important; color:#ffffff !important;}
    .btn-primary:hover,.btn-primary:focus,.btn-primary:active{background: #ff6565 !important;}
    .ey-head .user-info .breadcrumb a{ color:#ff6565;}
    .reg .header{background-color: #ff6565; }
    .radio-primary input[type=radio]:checked+label::before{border-color: #ff6565;}
    .checkbox-primary input[type=radio]:checked+label::before, .checkbox-primary input[type=checkbox]:checked+label::before{border-color: #ff6565; background:#ff6565}
    a.list-group-item.active, a.list-group-item.active:focus, a.list-group-item.active:hover{background: #ff6565;}
    footer.container a{ color:#ff6565  }
    input.form-control:hover,input.form-control:active,input.form-control:focus,input.input-txt:hover,input.input-txt:active,input.input-txt:focus{border-color:#ff6565;outline:none }
    .hamburger.is-closed .hamb-top,.hamburger.is-closed .hamb-middle,.hamburger.is-closed .hamb-bottom,.hamburger.is-open .hamb-bottom,.hamburger.is-open .hamb-top{background:#ff6565}
    .btn-outline.btn-success{color: #ff6565;border-color: #ff6565;}
    .btn-outline.btn-success.active, .btn-outline.btn-success:active, .btn-outline.btn-success:focus, .btn-outline.btn-success:hover, .open>.btn-outline.btn-success.dropdown-toggle {border-color:#ff6565;background-color:#ff6565;}
    .list-group-item a{ text-align:center; padding-left:0; }
    .panel-heading span.fr a{ color:#ff6565;}
    .shop .shop-order-top .ting h4{color:#ff6565;}
    .shop .shop-order-top .ting .price{color:#ff6565;}
    .shop-address li.selected a.addr-list{border: 1px solid #ff6565}

    /*图集上传 bug修正 2019.4.25*/
    .ui-sortable-placeholder{ display: inline-block; }
    .tab-pane .images_upload {
        float: left;
        width: 19%;
        margin-right: 1%;
        margin-top: 15px;
        display: inline-block;
    }

    .tab-pane .images_upload .ic{
        border: 1px solid #ddd;
        padding: 5px;
        border-radius: 4px;
        position: relative;
        float: left;
        background: #fff;
    }
    .tab-pane .images_upload .cover-bg{ background: #000; opacity: 0.5; width:100%; height: 100%; position: absolute; z-index: 2 }
    .tab-pane .images_upload .icaction{position: absolute; top:50%; margin-top: -15px; text-align: center; width:100%; z-index: 111}
    .tab-pane .images_upload .icaction span{ height: 28px; line-height: 28px; padding: 0 8px; background: #FF6666;  color: #fff; display: inline-block; cursor: pointer;}

    .tab-pane .images_upload .upimg img{
        vertical-align: middle;
        max-width: 100%;
        max-height: 140px;
    }
    .tab-pane .images_upload .ic img{
        position:absolute;
        top:50%;
        transform:translate(-50%,-50%);
        z-index: 1;
        left:50%;
    }
    .tab-pane .images_upload textarea{
        width:100%;
        box-sizing:
                border-box;
        margin-top: 5px;
        font-size: 13px;
        height: 50px;
        float: left;
        color: #999;
        border-color: #ddd;
        border-radius: 3px;
        -webkit-appearance: none;
        box-shadow: 0 1px 1px rgba(0, 0, 0, 0.065) inset;
        transition: all 1s cubic-bezier(0.175, 0.885, 0.32, 1) 0s;
    }
    .tab-pane .table-bordered{ width:100%; }
    .tab-pane a.upimg,.tab-pane div.upimg{
        height: 140px;
        background: #fafafa;
        overflow: hidden;
        text-align: center;
        position: relative;
        display: block;
    }

    .tab-pane .operation a{
        text-align: center;
        color: #666;
        outline: none;
        width: 33.3333%;
        float: left;
        font-size: 14px;

    }
    .tab-pane .operation a input{ display: inline-block; margin-right: 3px; vertical-align:middle; margin-top: -3px;}
    a.imgupload{
        display: inline-block;
        padding: .5em 1em;
        vertical-align: middle;
        font-size: 1.0rem;
        font-weight: 400;
        line-height: 1.2;
        text-align: center;
        white-space: nowrap;
        border-radius: 0;
        cursor: pointer;
        outline: 0;
        -webkit-transition: background-color .3s ease-out,border-color .3s ease-out;
        transition: background-color .3s ease-out,border-color .3s ease-out;
    }
    .tab-pane .operation a label{
        cursor: pointer;
    }
    a.imgupload i{font-size: 1.0rem;}

    @media (max-width:1680px) {
        .tab-pane .images_upload{width: 24%;}
        .tab-pane .operation a{ font-size: 12px; }
        .tab-pane .operation a label{cursor: pointer;}
    }
    div.tab-pane.pics a.upimg{ height: auto; padding: 8px; padding-bottom:0px; }
    div.tab-pane.pics .images_upload{ width:auto;position: relative; }
    div.tab-pane.pics .delect{ text-align: center; display: block; background: #fafafa;position: absolute;bottom: -3px;left: 0;color: #fff;  background-color:rgba(0,0,0,0.5);z-index: 2;width: 100%; }

    .template_div{margin: 5px 0px;}
    /*图集上传 end bug修正 2019.4.25*/

    /* 自定义开关字段 start */
    .onoff { font-size: 0; position: relative; overflow: hidden; display: block; float: left; }
    .onoff label { vertical-align: top; display: inline-block; *display: inline;
    *zoom: 1;
    cursor: pointer; }
    .onoff input[type="radio"] { position: absolute; top: 0; left: -999px; }
    .onoff .cb-enable
    { color: #777; font-size: 12px; line-height: 20px; background-color: #f8f8f8; height: 24px; padding: 1px 9px; border-style: solid; border-color: #ddd;border-radius:4px 0 0 4px; }
    .onoff .cb-disable { color: #777; font-size: 12px; line-height: 20px; background-color: #f8f8f8; height: 24px; padding: 1px 9px; border-style: solid; border-color: #ddd;border-radius:0 4px 4px 0; }

    .onoff .cb-enable { border-width: 1px 0 1px 1px; }
    .onoff .cb-disable { border-width: 1px 1px 1px 0;  }
    .onoff .cb-disable.selected { color: #FFF;background-color: #ff6565;border-color: #ff6565;border-radius: 0 4px 4px 0; }
    .onoff .cb-enable.selected { color: #FFF; background-color: #ff6565;border-color: #ff6565;border-radius:4px 0 0 4px; }
    /* 自定义开关字段 end */
</style>

<script type="text/javascript">
    var __root_dir__ = "/8744";
    var __version__ = "v1.5.4";
    var __lang__ = "cn";
</script>
    
    <script type="text/javascript" src="static/js/jquery.min-15681083121.js"></script><script type="text/javascript" src="static/js/layer.js"></script><script type="text/javascript" src="static/js/global.js"></script></head>

<body class="reg retrieve">


<div class="register_index ey-member">
    <div class="container">
    <form name='theForm' id="theForm" class="form-register panel-body fv-form">
        <div class="mip-reg-logo"><a href="https://demoall.yiyocms.com/8744" class="ey-logo"><img src="static/picture/63dd9e50068fb7641aebbe905ff3ca33.png"></a></div>
        <div class="mip-reg-heading">找回密码</div>
        <div class="form-group">
            <div class="input-group">
                <span class="input-group-addon"><i class="fa fa-envelope-o"></i></span>
                <input type="text" name="email" id="email" class="form-control" placeholder="邮箱地址">
            </div>
        </div>

        <div class="form-group">
            <div class="input-group btn-direction">
                <span class="input-group-addon"><i class="fa fa-envelope-o"></i></span>
                <div class="formText">
                    <input type="text" class="form-control" id="email_code" name="email_code" placeholder="邮箱验证码">
                </div>
                <input type="button" id="email_code_button" onclick="send_email();" class="btn btn-primary sento" value="点击发送">
            </div>
        </div>

        
        <button class="btn btn-lg btn-primary btn-block" style="width: 100%;" onclick="check_submit();" type="button">下一步</button>
        <div class="login_link"><a href="-user_Users_login.html">返回登录</a></div>
    </form>
    </div>
</div>

<script type="text/javascript">
    $(document).keydown(function(event){
        if(event.keyCode ==13){
            check_submit();
        }
    });
    
    function fleshVerify(){
        var src = "/8744/?m=api&c=Ajax&a=vertify&type=users_retrieve_password";
        if (src.indexOf('?') > -1) {
            src += '&';
        } else {
            src += '?';
        }
        src += 'r='+ Math.floor(Math.random()*100);
        $('#imgVerifys').attr('src', src);
    }

    function check_submit()
    {   
        var email = $('#email').val();
        var reg = /^[a-z0-9]([a-z0-9\\.]*[-_]{0,4}?[a-z0-9-_\\.]+)*@([a-z0-9]*[-_]?[a-z0-9]+)+([\.][\w_-]+){1,5}$/i;
        // 邮箱格式不正确
        if(!reg.test(email)){
            layer.msg('邮箱格式不正确，请正确输入邮箱地址！', {time: 1500});
            return false;
        }

        var email_code = $('#email_code').val();
        if(email_code == ''){
            layer.msg('邮箱验证码不能为空', {time: 1000});
            return false;
        }

        layer_loading('正在处理');
        $.ajax({
            // async:false,
            url: "/8744/?m=user&c=Users&a=retrieve_password",
            data: $('#theForm').serialize(),
            type:'post',
            dataType:'json',
            success:function(res){
                if (res.code == 1) {
                    window.location.href = res.url;
                } else {
                    layer.closeAll();
                    layer.msg(res.msg, {time: 2000, icon: 2});
                }
            },
            error : function() {
                layer.closeAll();
                layer.alert('网络失败，请刷新页面后重试', {icon: 5});
            }
        });
    };

    function send_email(email){
        var email = $('#email').val();
        var reg = /^[a-z0-9]([a-z0-9\\.]*[-_]{0,4}?[a-z0-9-_\\.]+)*@([a-z0-9]*[-_]?[a-z0-9]+)+([\.][\w_-]+){1,5}$/i;
        // 邮箱格式不正确
        if(!reg.test(email)){
            layer.msg('邮箱格式不正确，请正确输入邮箱地址！', {time: 1500});
            return false;
        }

        $("#email_code_button").val('发送中…');
        $("#email_code_button").attr('disabled', 'disabled');
        $.ajax({
            url: "/8744/?m=user&c=Smtpmail&a=send_email",
            data: {email:email,title:'找回密码',type:'retrieve_password',scene:4},
            type:'post',
            dataType:'json',
            success:function(res){
                if(res.code == 1){
                    countdown();
                    layer.msg(res.msg, {time: 1000});
                }else{
                    $("#email_code_button").val('点击发送');
                    $("#email_code_button").removeAttr("disabled");
                    layer.alert(res.msg, {icon: 2});
                }
            },
            error : function() {
                $("#email_code_button").val('点击发送');
                $("#email_code_button").removeAttr("disabled");
                layer.alert('网络失败，请刷新页面后重试', {icon: 5});
            }
        });
    };

    function countdown(){
        // 倒计时
        var setTime;
        var time = 120;
        setTime = setInterval(function(){
            if(0 >= time){
                clearInterval(setTime);
                return;
            }
            time--;
            $("#email_code_button").val(time+'秒');
            $("#email_code_button").attr('disabled', 'disabled');

            if(time == 0){
                $("#email_code_button").val('点击发送');
                $("#email_code_button").removeAttr("disabled");
            }
        },1000);
    }
</script>

</body>
</html>